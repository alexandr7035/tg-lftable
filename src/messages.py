import random
from datetime import datetime
import src.gettime
import src.static


def main_menu_message():

    text = '<b>LFTable v' + src.static.lftable_version + '</b>: –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –∑–∞–Ω—è—Ç–∏–π —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞ –ë–ì–£.\n\n'
    
    text += '–ò—Å—Ç–æ—á–Ω–∏–∫: law.bsu.by\n'
    text += '–ì—Ä—É–ø–ø–∞ –í–∫–æ–Ω—Ç–∞–∫—Ç–µ: vk.com/lftable\n'
    text += '–ë–æ—Ç –¥–ª—è –í–ö - –≤ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö —Å–æ–æ–±—â–µ—Å—Ç–≤–∞\n'

    # Use a string of 15 randomly mixed two space symbols to fix badrequest error.
    space = '\u0020'
    thin_space = '\u2009'

    for i in range(1,15):
        if random.randint(0,1) == 1:
            text += space
            #text += '1'
        else:
            #text += '0'
            text += thin_space
    # Newline symbol
    text += '\n'

    text += '–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ:'

    return(text)

def timetable_message(ttb):
    # THERE'S SEPARATE FUNCTIONS FOR USUAL AND CREDIT/EXAM TIMETABLES. SEE src.gettime.py
    # Get the timetable's "mtime"
    if ttb in src.static.credit_exam_timetables:
        data = src.gettime.credit_ekzam_gettime(ttb)
        ttb_datetime = data['time']
        ttb_url = data['url']
    else:
        ttb_datetime = src.gettime.ttb_gettime(ttb)
        ttb_url = ttb.url

    # Change date to necessary format.
    update_time = ttb_datetime.strftime('%H:%M')
    update_date = ttb_datetime.strftime('%d.%m.%Y')

    # Form the message's text
    text = '<b>' + ttb.name + '</b>\n\n'

    text += '–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: ' + update_date + '\n'
    text += '–í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: '+ update_time + '\n\n'

    text += '<b>–°–∫–∞—á–∞—Ç—å</b>: ' + ttb_url + "\n\n"

    # To fix badrequest error.
    text += '-------------------\n'
    text += '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞: ' + datetime.now().strftime("%d.%m.%Y %H:%M:%S")

    # Return this text
    return(text)

def notification_message(ttb, update_time):
    text = 'üîî –û–±–Ω–æ–≤–ª–µ–Ω–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ <b>"' + ttb.name + '". üîî</b>\n'
    text += '–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: ' + update_time.strftime('%d.%m.%Y') + '\n'
    text += '–í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: '+ update_time.strftime('%H:%M') + '\n\n'
    text += '<b>–°–∫–∞—á–∞—Ç—å</b>: ' + ttb.url + "\n\n"

    return (text)

def no_such_command_message():
    text = '‚ö†Ô∏è –ö–æ–º–∞–Ω–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.\n'
    text += 'üí° –ë–æ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π. '
    text += '–ß—Ç–æ–±—ã –≤—ã–∑–≤–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é, –≤–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É /start'

    return(text)